{% extends "base.html" %}
{% block title %}Manage Sub-users{% endblock %}
{% block content %}
<div class="max-w-2xl mx-auto mb-6 space-y-4">
  <div class="flex justify-between items-center">
    <h1 class="text-2xl font-bold mb-4 text-slate-800 leading-tight">Manage<br><span class="text-blue-700">Sub-users</span></h1>
    <a href="{{ url_for('routes.create_subuser') }}" class="inline-flex items-center px-4 py-1.5 border border-blue-400 text-blue-600 hover:text-blue-800 rounded-xl text-sm font-medium hover:bg-blue-50 transition shadow-sm">‚Üê Back to Previous Page</a>
  </div>
  <div class="bg-white/10 backdrop-blur-xl border border-white/20 shadow-xl rounded-2xl p-6">
    {% if subusers %}
    <div class="space-y-6">
      {% for sub in subusers %}
      <form method="POST" class="bg-white/20 backdrop-blur border border-white/20 rounded-xl p-4 shadow space-y-4">
        <input type="hidden" name="sub_id" value="{{ sub.id }}">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
          <div class="flex-1">
            <label for="name_{{ sub.id }}" class="block text-sm font-medium mb-1">Sub-user Name</label>
            <input id="name_{{ sub.id }}" type="text" name="name" value="{{ sub.name }}" class="w-full px-3 py-2 border rounded-xl bg-white/50 backdrop-blur border-white/20 placeholder-slate-500 text-slate-800 text-sm" required>
          </div>
          <div class="flex-1">
            <label for="machine_{{ sub.id }}" class="block text-sm font-medium mb-1">Assigned Machine</label>
            <select id="machine_{{ sub.id }}" name="machine_id" class="w-full px-3 py-2 border rounded-xl bg-white/50 backdrop-blur border-white/20 text-slate-800 text-sm" required>
              <option value="">Select a machine</option>
              {% for m in machines %}
              <option value="{{ m.id }}" {% if sub.assigned_machine_id == m.id %}selected{% endif %}>{{ m.name }} ({{ m.type }})</option>
              {% endfor %}
            </select>
          </div>
          <div class="flex flex-col gap-2 sm:items-center mt-4 sm:mt-0 sm:flex-row">
            <button type="submit" name="action" value="update" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl text-sm shadow-md">Update</button>
            <button type="submit" name="action" value="delete" onclick="return confirm('Are you sure you want to delete this sub-user?')" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-xl text-sm shadow-md">Delete</button>
          </div>
        </div>
      </form>
      {% endfor %}
    </div>
    {% else %}
      <p class="text-slate-600">No sub-users created yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
